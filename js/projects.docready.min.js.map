{"version":3,"sources":["projects.docready.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"projects.docready.min.js","sourcesContent":["(function($) {\n\n//\"use strict\";\n\n// Global Variables\nvar ww = $(window).width(),\n    wh = $(window).height(),\n    headerheight = 105,\n    footerheight = 45,\n    iah = wh-headerheight-footerheight,\n    siteratio = ww / iah,\n    minww = 0,\n    minwh = 0,\n    gutter = 0,\n    easing = \"jswing\",\n    speed = 400,\n    fadeOutSpeed = 300,\n    fadeInSpeed = 700,\n    currenturl = window.location.pathname;\n\n$(document).ready(function() {\n  /*\n  if($('.admin-bar').first().length > 0) {\n    headerheight = 105+32;\n  }\n  */\n\n  /* -------  Button for menu dropdown on smaller screens --------- */\n  /*$('.header__icon').click(function(e) {\n    $('.header__icon').toggleClass('is-active');\n    $('.large-menu').toggleClass('is-active');\n    $('.large-menu-mobile').toggleClass('is-active');\n    return false;\n    });*/\n  $('.header__icon').click(function(e) {\n      if( $('body').hasClass('home') ) {\n          e.preventDefault();\n          $('.header__icon').toggleClass('is-active');\n          $('.large-menu').toggleClass('is-active');\n          $('.large-menu_mobile').toggleClass('is-active');\n          $('.large-menu-search').toggleClass('is-active');\n          return false;\n      } else {\n\n      }\n  });\n\n\n  /* -------  Button for footer expand --------- */\n  $('.single-expand').click(function(e) {\n    e.preventDefault();\n    /* IF the footer is already expanded then lower it */\n    if( $('.single-footer__container').hasClass('expanded') ) {\n      $('.single-footer__container').stop().animate( { height: footerheight }, { duration: 20, easing: 'jswing' } );\n      $('.single-below-footer__container').stop().animate( { marginTop:0 }, { duration: 20, easing: 'jswing' } );\n      $('.single-footer__container').removeClass('expanded');\n      $('.single-footer__more').text(' / Read More');\n    }\n    else {\n      adjustFooterHeight();\n      $('.single-footer__container').addClass('expanded');\n      $('.single-footer__more').text(' / Hide Text');\n    }\n  });\n\n  /* -------  If smaller screen add mobile class to main div --------- */\n  if( $(window).width() > 769 ) {\n    $('#proj_img').addClass('large').removeClass('mobile');\n    $('#proj_img_container').addClass('large').removeClass('mobile');\n    $('proj_img img').addClass('slide');\n  } else {\n    $('#proj_img').removeClass('large').addClass('mobile');\n    $('#proj_img_container').addClass('mobile').removeClass('large');\n    $('#proj_img img').removeClass('slide');\n    $('.arrw').hide();\n  }\n\n  /* -------  On resizing, check the screen size again --------- */\n  $(window).resize(function() {\n    if($(window).width() > 769) {\n      if($('.mobile').length > 0) {\n        $('#proj_img').addClass('large').removeClass('mobile');\n        $('#proj_img_container').addClass('large').removeClass('mobile');\n\n        $(\"#proj_img img\").hide();\n        $('#proj_img .active img').first().fadeIn(400);\n\n        var caption = $('#proj_img .active img').first().nextAll('.caption').first().html();\n        var description = $('#proj_img .active img').first().nextAll('.description').first().html();\n        var imagedate = $('#proj_img .active img').first().nextAll('.date').first().html();\n\n        $('.single-footer__caption').html(caption);\n        $('.single-footer__caption-date').html(imagedate);\n        $('.single-below-footer__description').html(description);\n      }\n    }\n    else {\n      $('#proj_img').removeClass('large').addClass('mobile');\n      $('#proj_img_container').removeClass('large').addClass('mobile');\n\n    }\n    resizeSite();\n  });\n\n\n  resizeSite();\n  //$(window).resize(resizeSite);\n\n  // When History changes, get the current page\n  // TODO: Check this:\n\tvar History = window.History;\n\tif (History.enabled) {\n\t\tHistory.Adapter.bind(window,'statechange',function(){\n      var State = History.getState();\n\t\t\tvar url = document.createElement('a');\n\t\t\turl.href = State.url;\n\t\t\tgetPage(url.pathname,false);\n\t\t});\n\t\tvar hash = window.location.hash;\n\t\tif(hash){\n\t\t\tHistory.Adapter.trigger(window, 'statechange')\n\t\t}\n\t}\n\n  // Hide Images and Fade in the first one\n  if(!$.browser.msie) {\n    if($(\"#proj_img\").length > 0) {\n      //hide all images\n      $(\"#proj_img img\").hide();\n      $('#proj_img .active img').first().fadeIn(400);\n      var caption = $('#proj_img .active img').first().nextAll('.caption').html();\n      var description = $('#proj_img .active img').first().nextAll('.description').html();\n      var imagedate = $('#proj_img .active img').first().nextAll('.date').html();\n\n      $('.single-footer__caption').html(caption);\n      $('.single-footer__caption-date').html(imagedate);\n      $('.single-below-footer__description').html(description);\n\n      // TODO: Check why this on load isn't working!!\n      /*firstImg.on('load',function(){\n        console.log('showing');\n        $(this).fadeIn(400);\n      });*/\n    }\n  }\n\n  // Project Table Sorting?\n\n  // Project Slider\n  $(\"#proj_img.project .arrw\").click(function(  ) {\n    var thislink = $(this);\n\n    if($(this).hasClass(\"left\")) {\n      var dir = \"l\";\n    }\n    else if ($(this).hasClass(\"right\")) {\n      var dir = \"r\";\n    }\n    else if ($(this).hasClass(\"up\")) {\n      var dir = \"u\";\n    }\n    else if ($(this).hasClass(\"down\")) {\n      var dir = \"d\";\n    }\n\n    resizeSite();\n\n\n    var thisSlideShow = $(\"#proj_img\");\n    var thisProject = $(\".proj.active\");\n    var current = $(\".proj.active .slide:visible\");\n\n    /*  ----- CLICK LEFT (Prev Slide) -------*/\n    if (dir == \"l\") {\n      if (thisProject.find(\".slide\").length > 1) {\n        // if the current slide is not the first then move one to the left.\n        if (current.prevAll(\".proj.active .slide\").first().length > 0) {\n          var slideToShow = current.prevAll(\".proj.active .slide\").first();\n        }\n        // if the current slide IS the first one then slide to the last slide\n        else {\n          var slideToShow = $(\".proj.active .slide\").eq($(\".proj.active .slide\").length-1);\n        }\n\n        /* If the footer is epanded, shrink it */\n        if( $('.single-footer__container').hasClass('expanded' ) ) {\n          $('.single-expand').click();\n        }\n\n        if (thisSlideShow.hasClass(\"fading\")){\n\t\t\t\t\tcurrent.fadeOut(fadeOutSpeed);\n\t\t\t\t\tslideToShow.fadeIn(fadeInSpeed);\n\t\t\t\t}\n        else if ( thisSlideShow.hasClass(\"sliding\")) {\n          // TODO: Check if Pete wants centred or Left oriented\n          var imgDim = imgResize(slideToShow, ww, iah, \"array\", 0, 0, 0, 0);\n          var currentLeft = current.offset().left;\n          var nextCurrentLeft = currentLeft + ww + gutter;\n          var nextNextLeft = (imgDim[2]-ww-gutter);\n\n          current.stop().animate({ left:nextCurrentLeft }, { duration: speed, easing: easing } ).hide(0).css(\"left\",currentLeft+\"px\");\n          slideToShow.css( \"left\" , nextNextLeft + \"px\" ).show(0).stop().animate({ left:imgDim[2] },{ duration: speed, easing: easing });\n        }\n        var captionText = slideToShow.next(\"span\").html();\n        $(\"footer .imgcap\").html(captionText);\n        if (slideToShow.hasClass(\"video\")) {\n          $(\".arrw.left, .arrw.right\").height(iah/2);\n          $(\".arrw.down\").hide();\n        }\n        else {\n          $(\"arrw.left, .arrw.right\").height(iah-120);\n          $(\"arrw.down\").show();\n        }\n        // If we want the image numebr...\n        // TODO: Add the diagram to the bottom right showing image boxes and update\n        //$(\"#footer .ic\").text(slideToShow.index(\".proj.active .slide\")+1);\n      }\n    }\n\n    /*  ----- CLICK RIGHT (Next Slide) -------*/\n    else if (dir == \"r\") {\n      if (thisProject.find(\".slide\").length > 1) {\n        if (current.nextAll(\".proj.active .slide\").first().length > 0) {\n          // If we're not on the last slide, move one forward\n          var slideToShow = current.nextAll(\".proj.active .slide\").first();\n          //$('.moving_bg').animate({left: \"+=13\"}, 500);\n        }\n        else {\n          // if we are on the last slide move back to the start\n          var slideToShow = $(\".proj.active .slide:first-child\");\n          //$('.moving_bg').animate({left: 0}, 500);\n        }\n\n        /* If the footer is expanded, shrink it */\n        if( $('.single-footer__container').hasClass('expanded') ) {\n          $('.single-expand').click();\n        }\n\n        if (thisSlideShow.hasClass(\"fading\")) {\n          current.fadeOut(fadeOutSpeed);\n          slideToShow.fadeIn(fadeInSpeed);\n        }\n        else if (thisSlideShow.hasClass(\"sliding\")) {\n          // TODO: Check if Pete wants left justified.\n\n          var imgDim = imgResize(slideToShow,ww,iah,\"array\",0,0,0,0);\n          var currentLeft = current.offset().left;\n          var nextCurrentLeft = -(ww+gutter);\n          var nextNextLeft = (imgDim[2]+ww+gutter);\n          current.stop().animate({ left: nextCurrentLeft },{ duration: speed, easing: easing }).hide(0).css(\"left\",currentLeft+\"px\");\n          slideToShow.css(\"left\", nextNextLeft+\"px\").show(0).stop().animate({ left: imgDim[2] }, { duration: speed, easing: easing });\n        }\n\n        var captionText = slideToShow.next(\"span\").html();\n        $(\"#footer .imgcap\").html(captionText);\n        if (slideToShow.hasClass(\"video\")) {\n          $(\".arrw.left, .arrw.right\").height(iah/2);\n          $(\".arrw.down\").hide();\n        }\n        else {\n          $(\".arrw.left, .arrw.right\").height(iah-120);\n          $(\".arrw.down\").show();\n        }\n\n        // If we want the image number... or the image map\n        // TODO: Add the diagram to the bottom right showing image boxes and update\n        //$(\"#footer .ic\").text(slideToShow.index(\".proj.active .slide\")+1);\n        //$(\"#footer .ic\").text(slideToShow.index(\".proj.active .slide\")+1);\n      }\n    }\n    else if (dir == \"u\" || dir == \"d\") {\n      /* TODO: Does this update the caption as well? */\n      var href = thislink.attr(\"href\");\n      History.pushState(null, null, href);\n    }\n\n    if (dir == \"l\" || dir == \"r\") {\n      // TODO: if footer is expanded then close the footer\n    }\n\n\n\n    return false;\n  }); // close >> #proj_img.project .arrw click\n\n  // Use Keyboard instead of Mouse\n  $(document).keydown(function(e) {\n    if (e.which == 37 && !e.metaKey) {\n      e.preventDefault();\n      $(\".arrw.left\").click();\n    }\n    else if (e.which == 38 && !e.metaKey) {\n      e.preventDefault();\n      $(\".arrw.up\").click();\n    }\n    else if (e.which == 39 && !e.metaKey) {\n      e.preventDefault();\n      $(\".arrw.right\").click();\n    }\n    else if (e.which == 40 && !e.metaKey) {\n      e.preventDefault();\n      $(\".arrw.down\").click();\n    }\n  });\n\n  // NOTE: jQuery.touchSwipe.min.js\n  $(\".arrw\").swipe( {\n      //Generic swipe handler for all directions\n      swipe:function(event, direction, distance, duration, fingerCount, fingerData) {\n        console.log(\"You swiped \" + direction );\n        if(direction == \"left\") {\n          $('.arrw.right').click();\n        }\n        if(direction == \"right\") {\n          $('.arrw.left').click();\n        }\n        if(direction == \"down\") {\n          $('.arrw.up').click();\n        }\n        if(direction == \"up\") {\n          $('.arrw.down').click();\n        }\n      }\n    });\n\n});  // close >> document(ready)\n\n$(window).load(function(){\n  getPrevAndNextButtons($(\".proj.active\"));\n\tloadPrevAndNextProject($(\".proj.active\"));\n  //generateTabs();\n});\n\n\n/* Resize Site */\nfunction resizeSite() {\n  ww = $(window).width();\n  wh = $(window).height();\n  iah = wh - headerheight - footerheight;\n  siteratio = ww / iah;\n\n  if(ww < minww) ww = minww;\n  if(wh < minwh) wh = minwh;\n\n  // resize the container\n  $('#site, .scrollwrap, .site').width(ww).height(iah);\n  $('#proj_img').width(ww).height(iah);\n  $('#proj_img').css('width', ww + \"px\").css('height', iah + \"px\");\n\n  // resize each picture\n  $('#proj_img .slide').each(function() {\n    var thisimg = $(this);\n    var iR = parseFloat(thisimg.data(\"r\"));\n    var sf = thisimg.data(\"f\");\n\n    if (sf == 200) {\n      sf = 1;\n      var fit = false;\n    }\n    else {\n      sf = parseFloat(sf / 100);\n      var fit = true;\n    }\n    if ($(this).hasClass(\"full\")) {\n      var thisimg = $(this);\n      containerW = ww;\n      containerH = iah;\n      containerAspect = ww / iah;\n      imageAspect = iR;\n\n      if ( containerAspect < imageAspect ) {\n          var iw = iah * imageAspect;\n          $(this)\n            .css('width', iw)\n            .css('height', iah)\n            .css('top', '0')\n            .css('left', (-(iah*imageAspect-ww)/2));\n      } else {\n          var ih = ww / imageAspect;\n          $(this)\n            .css('width', ww)\n            .css('height', ih)\n            .css('top', (-(ww/imageAspect-iah)/2))\n            .css('left', '0');\n      }\n\n    }\n    else {\n      imgResize(thisimg, ww, iah, \"position\", 0, 0, 0, 0)\n    }\n  });\n  //end resize each picture\n\n  var currentSlide = $(\".slideshow .slide:visible\");\n  if (currentSlide.length > 0 && currentSlide.hasClass(\"video\")) {\n    if($(\".arrw.down\").length > 0) {\n      $(\".arrw.left, .arrw.right\").height(iah/2).width(ww/2-ww/2);\n      $(\".arrw.down\").hide();\n    }\n    else {\n      $(\".arrw.left, .arrw.right\").height(iah/1.5).width(ww/2-ww/2);\n    }\n  }\n  else {\n    $(\".arrw.left, .arrw.right\").height(iah-iah/4).width(ww/2-ww/10);\n    $(\".arrw.down\").show();\n  }\n}\n/* End Resize Site */\n\n/* Resize Image */\nfunction imgResize(el, cw, ch, prop, woff, hoff, loff, toff) {\n  // element, container width, height, css prop (margin/top), width offset, height offset, left offset, top offset\n  var iR = parseFloat(el.data(\"r\"));\n  var sf = el.data(\"f\");\n\n  if(sf == 200) {\n    sf = 1;\n    var fit = false;\n  }\n  else {\n    sf = parseFloat(sf/100);\n    var fit = true;\n  }\n\n  //element ratio\n  var ir = parseFloat(el.data(\"r\"));\n  if (!ir) {\n    ir = el.width() / el.height();\n  }\n  //scale factor\n  if (!sf) {\n    sf = 1;\n  }\n\n  // fit inside container\n  if (fit) {\n    var cr = (cw - woff) / (ch - hoff);\n    if (cr > ir) {\n      var ih = (ch - hoff) * sf;\n      var iw = ih * ir;\n    }\n    else {\n      var iw = (cw - woff) * sf;\n      var ih = iw / ir;\n    }\n    var imt = (ch - hoff - ih) / 2;\n    //var imt = 0; // over-riding to force the image to be top of screen\n    var iml = (cw - woff - iw) / 2;\n  }\n  // fill container\n  else {\n    var cr = (cw / ch);\n    if (ir < 1) {\n      //image is portrait\n      var iw = cw;\n      var ih = iw/ir;\n      if (ih < ch) {\n        var ih = ch;\n        var iw = ih * ir;\n        var iml = (cw - iw) / 2 - loff;\n        var imt = (ch - ih) / 2 - toff;\n      }\n      else {\n        var imt = (ch - ih) / 2 - toff;\n        var iml = (cw - iw) / 2 - loff;\n      }\n    }\n    // image is landscape\n    else {\n      var ih = ch;\n      var iw = ih * ir;\n      if (iw < cw) {\n        var iw = cw;\n        var ih = iw/ir;\n      }\n      var iml = (cw - iw) / 2 - loff;\n      var imt = (ch - ih) / 2 - toff;\n    }\n  }\n\n  if(el.hasClass('full')) {\n    var iw = cw;\n    var ih = ch;\n    var iml = 0;\n    var imt = 0;\n  }\n\n  if (prop == \"margin\") {\n    el.width(iw).height(ih).css({marginTop:imt+\"px\", marginLeft:iml+\"px\"});\n  }\n  else if (prop == \"position\") {\n    el.width(iw).height(ih).css({top:imt+\"px\",left:iml+\"px\"});\n    if( el.hasClass('video') ) {\n      el.find('iframe').height(ih).width(iw);\n    }\n  }\n  else if (prop == \"array\") {\n    var imgDim = new Array(4);\n    imgDim[0] = iw;\n    imgDim[1] = ih;\n    imgDim[2] = iml;\n    imgDim[3] = imt;\n    return imgDim;\n  }\n}\n/* End Resize Image */\n\n/* Start: adjustFooterHeight */\nfunction adjustFooterHeight() {\n  var fh = $('.single-footer__container').height();\n  var bfh = $('.single-below-footer__container').outerHeight();\n  if ( bfh < 33 ) bfh = 0;\n  $('.single-footer__container')\n    .stop()\n    .animate( { height: bfh + footerheight }, { duration: 200, easing: 'jswing'} );\n  $('.single-below-footer__container')\n    .stop()\n    .animate( { marginTop: -(bfh) }, { duration: 200, easing: 'jswing' } );\n}\n/* End: adjustFooterHeight */\n\n\n\n\n/* Get Current Page URL */\nfunction getPage(href, push) {\n  if (href[0] != \"/\") { href = \"/\" + href; }\n  if (currenturl[0] != \"/\") { currenturl = \"/\" + currenturl; }\n\n  var l = href.split(\"/\");\n  var cl = currenturl.split(\"/\");\n\n  if (href != currenturl) {\n    if ( l[2] == \"project\" ) {\n      // send the slug only\n      goToProject(href, l[3]);\n    }\n    currenturl = href;\n  }\n}\n/* End Get Current Page URL */\n\n/* Go to Project */\nfunction goToProject(href, slug) {\n  var thisSlideShow = $('#proj_img');\n  var thisProj = $(\".proj.active\");\n  var current = $(\".proj.active .slide:visible\");\n\n  nextProj = $(\"#p_\" + slug);\n  if (nextProj.index() > thisProj.index()) {\n    if (thisProj.index() == 0 && nextProj.index() == $(\".proj\").length-1) {\n      var dir = \"u\";\n    }\n    else {\n      var dir = \"d\";\n    }\n  }\n  else {\n    if (thisProj.index() == $(\".proj\").length-1 && nextProj.index() == 0){\n      var dir = \"d\";\n    }\n    else {\n      var dir = \"u\";\n    }\n  }\n  if (nextProj.html() == \"\") {\n    getNewProject(thisProj, current, nextProj, dir, true);\n  }\n  else {\n    slideToProject(thisProj, current, nextProj, dir);\n  }\n\n}\n\nfunction getNewProject(thisProject, current, nextProj, dir, doSlide) {\n  var project_id = nextProj.data(\"id\");\n\n  // TODO: Add Ajax to retrieve the next project images\n  jQuery.ajax({\n    url: ajaxgetprojectimgs.ajaxurl,\n    type: 'post',\n    data: {\n      action: 'ajax_get_project_imgs',\n      project_id: project_id,\n    },\n    dataType: 'json',\n    success: function(result) {\n      jQuery.each(result, function(index, value) {\n        nextProj.append(value);\n      });\n      resizeSite();\n\n      if (doSlide) {\n        slideToProject(thisProject, current, nextProj, dir);\n      }\n    }\n  });\n}\n\n/* Load Previous and Next Project Images */\nfunction loadPrevAndNextProject(thisProj) {\n  // is the next project the next one along?\n  if (thisProj.next(\".proj\").first().length>0) {\n    var nextProj = thisProj.nextAll(\".proj\").first();\n  }\n  // if not then the next project is the first project\n  else {\n    var nextProj = $(\".proj:first-child\");\n  }\n  // If the next project is currently empty, load in the images\n  if (nextProj.html() == \"\") {\n    getNewProject(thisProj, \"\", nextProj, \"\", false);\n  }\n\n  // is the previous project one back?\n  if (thisProj.prevAll(\".proj\").first().length > 0) {\n    var prevProj = thisProj.prevAll(\".proj\").first();\n  }\n  // if not then the previous project is the last project\n  else {\n    var prevProj = $(\".proj\").eq($(\"proj\").length-1);\n  }\n\n  // If the previous project is currently empty, load in the images\n  if (prevProj.html() == \"\") {\n    getNewProject(thisProj, \"\", prevProj, \"\" , false);\n  }\n}\n/* End Load Previous and Next Project Images */\n\nfunction slideToProject(thisProj, current, nextProj, dir) {\n  var currentLeft = current.offset().left;\n  var slideToShow = nextProj.find(\".slide:first-child\");\n\n  var imgDim = imgResize(slideToShow, ww, iah, \"array\", 0, 0, 0, 0);\n\n  var currentTop = current.offset().top;\n\n  var table = nextProj.parent().data(\"t\");\n  if (table == \"projects\") {\n    var directory = \"project\";\n  }\n\n  /* If the footer is epanded, shrink it */\n  if( $('.single-footer__container').hasClass('expanded' ) ) {\n    $('.single-expand').click();\n  }\n\n  if (dir == \"u\") {\n    current.stop().animate({ top: currentTop+wh+gutter } , { duraction: speed-100, easing: easing }).hide().css(\"top\", currentTop + \"px\");\n    slideToShow.css(\"top\",(imgDim[3]-wh-gutter)+\"px\").show(0).stop().animate({ top:imgDim[3] },{ duration: speed, easing: easing });\n\n    var newLeft = ($(\".proj.active .slide\").length-1) * 13;\n    //$('.moving_bg').animate({left: 0}, 500);\n  }\n  else {\n    current.stop().animate({top:(currentTop-wh)},{duration: speed-100, easing: easing}).hide(0).css(\"top\",currentTop+\"px\");\n    slideToShow.css(\"top\",(ww+imgDim[3])+\"px\").show(0).stop().animate({ top: imgDim[3] },{ duration: speed, easing: easing });\n    //$('.moving_bg').animate({left: 0}, 500);\n  }\n\n  thisProj.removeClass(\"active\");\n  nextProj.addClass(\"active\");\n\n  var caption = $('#proj_img .active img').first().nextAll('.caption').first().html();\n  var description = $('#proj_img .active img').first().nextAll('.description').first().html();\n  var imagedate = $('#proj_img .active img').first().nextAll('.date').first().html();\n\n  $('.single-footer__caption').html(caption);\n  $('.single-footer__caption-date').html(imagedate);\n  $('.single-below-footer__description').html(description);\n\n  getPrevAndNextButtons(nextProj);\n  document.title = (nextProj.data(\"title\")) + \"- Structure Workshop\";\n  loadPrevAndNextProject(nextProj);\n\n\n}\n\nfunction getPrevAndNextButtons(thisProj) {\n  var table = thisProj.parent().data(\"t\");\n  if (table == \"projects\") {\n    var directory = \"project\";\n  }\n\n  if (thisProj.next(\".proj\").first().length>0) {\n    var nextProj = thisProj.nextAll(\".proj\").first();\n  }\n  // if not then the next project is the first project\n  else {\n    var nextProj = $(\".proj:first-child\");\n  }\n\n  // is the previous project one back?\n  if (thisProj.prevAll(\".proj\").first().length > 0) {\n    var prevProj = thisProj.prevAll(\".proj\").first();\n  }\n  // if not then the previous project is the last project\n  else {\n    var prevProj = $(\".proj\").eq($(\"proj\").length-1);\n  }\n\n  var nextURL = siteUrl + \"/\" + directory + \"/\" + nextProj.attr(\"id\").replace(\"p_\",\"\");\n  var prevURL = siteUrl + \"/\" + directory + \"/\" + prevProj.attr(\"id\").replace(\"p_\",\"\");\n\n  $(\".arrw.down\").attr(\"href\", nextURL).attr(\"data-id\",nextProj.data(\"id\"));\n  $(\".arrw.up\").attr(\"href\", prevURL).attr(\"data-id\",prevProj.data(\"id\"));\n\n}\n\n\nfunction generateTabs() {\n  var projects = $('.proj');\n  var numProjects = projects.length;\n  for(var i = 0; i<numProjects; i++) {\n    $('.tabs_container').append('<div class=\"tabs\"></div>');\n  }\n\n  var projectImages = new Array(numProjects);\n  projects.each(function(index) {\n    projectImages[index] = $(this).find('img').length;\n    for(var i = 0; i<projectImages[index]; i++) {\n      $('.tabs_container .tabs').eq(index).append('<span class=\"tab_item\"></span>');\n    }\n    if($('.tabs').eq($('.proj.active').index()).find('.moving_bg').length == 0) {\n      $('.tabs').eq($('.proj.active').index()).append('<div class=\"moving_bg\"></div>');\n    }\n  });\n  console.log(projectImages);\n}\n\n})( jQuery );\n"]}